#!/usr/bin/env python

from optparse import OptionParser

import tornado.web
import tornado.ioloop

from gpgtweet.server import utils
from gpgtweet.server import auth 
from gpgtweet.server import messages 
from gpgtweet.server.config import GPGTweetConfig
from gpgtweet.server.application import GPGTweetServer

def parse_options():
    parser = OptionParser()
    parser.add_option('-c', '--config-file',
                      help="Configuration File for GPGTweet Server",
                      default="gpgtweet.cfg", action="store", type="string",
                      dest="config_file")
    parser.add_option('-a', '--listen-address',
                      help="Listen Address for Tornado Server",
                      default="127.0.0.1", action="store", type="string",
                      dest="listen_address")
    parser.add_option('-p', '--port',
                      help="Port for Tornado Server",
                      default="8888", action="store", type="int",
                      dest="listen_port")
    (options, args) = parser.parse_args()
    return (options, args)

if __name__ == "__main__":
    (options, args) = parse_options()

    server = GPGTweetServer(options.config_file)
    server.application.listen(options.listen_port, address=options.listen_address)
    tornado.ioloop.IOLoop.instance().start()
